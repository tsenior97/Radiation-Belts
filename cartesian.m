m=1.6726e-27;
q=1.6022e-19;
R_E=6370000
B_0=3.15e-5
k_0=B_0*(R_E)^3
r=@(v) sqrt(v(1)^2+v(2)^2+v(3)^2)
B_x=(-3*k_0*v(1)*v(3))/(sqrt(v(1)^2+v(2)^2+v(3)^2))^5
B_y=(-3*k_0*v(2)*v(3))/(sqrt(v(1)^2+v(2)^2+v(3)^2))^5
B_z=(k_0/(sqrt(v(1)^2+v(2)^2+v(3)^2))^5)*(v(1)^2+v(2)^2-2*v(3)^2)
E=[0,0,0];
g=[0,0,0];
f=@(t,v)[v(4);v(5);v(6);
    q/m*(v(5)*B(3)-v(6)*B(2)+E(1))+g(1);
    q/m*(v(6)*B(1)-v(4)*B(3)+E(2))+g(2);
    q/m*(v(4)*B(2)-v(5)*B(1)+E(3))+g(3)];
opts=odeset('RelTol',1e-13,'AbsTol',1e-15);
[t,va]=ode45(f,[0 100],[0 0 0 0 0 0],opts);
plot3(va(:,1),va(:,2),va(:,3))
xlabel('x')
ylabel('z')
grid on